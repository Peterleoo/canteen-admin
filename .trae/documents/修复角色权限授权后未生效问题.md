## 问题分析

**根本原因**：前端权限验证依赖硬编码的角色权限配置，而非从数据库动态获取实际权限。

**具体问题**：
1. `hasPermission` 函数使用硬编码的 `ROLE_PERMISSIONS` 对象进行权限验证
2. 用户登录时只获取基本信息和角色，未获取实际权限列表
3. 角色权限更新后，前端仍使用旧的硬编码配置

## 修复方案

### 1. 修改用户类型定义
- 在 `AdminUser` 接口中添加 `permissions` 字段，用于存储用户实际拥有的权限

### 2. 修改登录逻辑
- 在用户登录时，获取用户所属角色的实际权限列表
- 将权限列表存储到用户信息中

### 3. 修改权限验证逻辑
- 更新 `hasPermission` 函数，使用用户实际拥有的权限列表进行验证
- 移除或修改硬编码的 `ROLE_PERMISSIONS` 对象，改为动态获取权限

### 4. 更新API调用
- 确保用户获取API返回用户的权限列表
- 支持从数据库获取角色权限关联

## 实现步骤

1. **修改类型定义**：在 `src/types/index.ts` 中为 `AdminUser` 添加 `permissions` 字段
2. **修改登录API**：在 `src/api/auth.ts` 中修改登录逻辑，获取用户权限
3. **更新状态管理**：确保 `useAuthStore` 正确存储用户权限
4. **修改权限验证**：更新 `src/utils/rbac.ts` 中的 `hasPermission` 函数
5. **测试验证**：确保权限授权后，用户重新登录能获取到最新权限

## 预期效果

- 管理员修改角色权限后，相关用户重新登录将获取到最新权限
- 权限验证基于数据库实际配置，而非硬编码配置
- 支持更灵活的角色权限管理

## 文件修改清单

1. `src/types/index.ts` - 添加权限字段
2. `src/api/auth.ts` - 登录时获取权限
3. `src/utils/rbac.ts` - 更新权限验证逻辑
4. `src/api/settings.ts` - 可能需要添加获取角色权限的API
5. `src/stores/useAuthStore.ts` - 更新状态类型